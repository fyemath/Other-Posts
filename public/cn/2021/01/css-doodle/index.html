<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>用 CSS-Doodle 为网页添加几何美图 | </title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link href="/css/customized.css" type="text/css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.0/jquery.min.js"></script>
<script src="/js/thm-numbering.js"></script>
<script src="/js/article-meta-height.js"></script>

<script src="/js/background-by-season.js"></script>

<link href="/css/prism-okaidia.css" type="text/css" rel="stylesheet"/>

<link href="/css/fonts-en-cn.css" type="text/css" rel="stylesheet"/>

<link href="/css/css-doodle.css" type="text/css" rel="stylesheet"/>

<script src="https://unpkg.com/css-doodle@0.13.2/css-doodle.min.js"></script>



<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-regular.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-regular.woff" type="font/woff" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-italic.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-italic.woff" type="font/woff" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-700.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-700.woff" type="font/woff" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-700italic.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-700italic.woff" type="font/woff" crossorigin="anonymous">



<link rel="preload" as="font" href="/css/fonts/noto-sans-sc/noto-sans-sc-v12-chinese-simplified-regular.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans-sc/noto-sans-sc-v12-chinese-simplified-regular.woff" type="font/woff" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans-sc/noto-sans-sc-v12-chinese-simplified-700.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans-sc/noto-sans-sc-v12-chinese-simplified-700.woff" type="font/woff" crossorigin="anonymous">

<link rel="preload" as="font" href="/css/fonts/noto-serif-sc/noto-serif-sc-v8-chinese-simplified-regular.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-serif-sc/noto-serif-sc-v8-chinese-simplified-regular.woff" type="font/woff" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-serif-sc/noto-serif-sc-v8-chinese-simplified-700.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-serif-sc/noto-serif-sc-v8-chinese-simplified-700.woff" type="font/woff" crossorigin="anonymous">





<script>
  $(':root').css('--header-height', '0 px');

  $(document).ready(divHeight);
  $(window).on('resize', divHeight);

  function divHeight() {
    var dheight = $(".header h1").outerHeight(true)  + "px";
    document.documentElement.style.setProperty('--header-height', dheight);
  }
</script>

  </head>

  

  <body class="cn">
    <nav>
    <ul class="menu">
    
      
      <li><a href="/">首页</a></li>
      
      <li><a href="/cn/">博客</a></li>
      
      <li><a href="/cn/ctags/">标签</a></li>
      
      <li><a href="/en/">English</a></li>
      
    </ul>
    </nav>
    <hr/>




<div class="page">

<div class="article-title">
  <css-doodle use="var(--rule)" as-bg="" click-to-update=""></css-doodle>
  <div class="article-meta">
    <h1><span class="title">用 CSS-Doodle 为网页添加几何美图</span></h1>
    <h2 class="author">
    
        Fei Ye
    
    </h2>
    <h3 class="date">2021/01/14</h3>
  </div>
</div>

<main>
<p>最近试用了一下 <a href="https://css-doodle.com/">CSS-Doodle</a>, 效果很不错，见上图。</p>
<p>尽管官方教程已经非常清楚，但对于本人这种不太熟悉 CSS 的，学起来还是花了点时间。为了避免忘记，特以上图为例，简单解释一下实现方法，以求抛砖引玉。</p>
<h2 id="css-doodle-作图">CSS-Doodle 作图</h2>
<p>要在网页中显示 CSS-Doodle 图形，需要调用 css-doodle.js. 最简单的方法是将下面的代码加入到网页的 <code>&lt;head&gt;...&lt;/head&gt;</code> 中。</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://unpkg.com/css-doodle@0.13.4/css-doodle.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></div><p>由于 CSS-Doodle 的设计是基于 CSS 的，所以用 CSS-Doodle 作图时，既可以用 CSS 本身的语法，也可以用 CSS-Doodle 自身的语法 (详情可见 <a href="https://css-doodle.com/#usage">CSS-Doodle Usage</a>)。 但是代码要放入一个特殊的元素块：</p>
<div class="highlight"><pre class="chroma"><code class="language-css" data-lang="css"><span class="o">&lt;</span><span class="nt">css-doodle</span><span class="o">&gt;</span>
  <span class="c">/* 作图代码 */</span>
<span class="o">&lt;/</span><span class="nt">css-doodle</span><span class="o">&gt;</span>
</code></pre></div><p>例如，上面的图形，是由下面的代码生成的。</p>
<div class="highlight"><pre class="chroma"><code class="language-css" data-lang="css"><span class="o">&lt;</span><span class="nt">css-doodle</span><span class="o">&gt;</span>
  <span class="p">:</span><span class="nd">doodle</span> <span class="p">{</span>
    <span class="err">@</span><span class="k">grid</span><span class="p">:</span> <span class="mi">8</span> <span class="o">/</span> <span class="mi">100</span><span class="kt">vmax</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">@</span><span class="k">shape</span><span class="o">:</span> <span class="nt">clover</span> <span class="nt">5</span><span class="p">;</span>
  <span class="nt">background</span><span class="o">:</span> <span class="nt">hsla</span><span class="o">(</span>
    <span class="nt">calc</span><span class="o">(</span><span class="nt">100</span> <span class="nt">-</span> <span class="p">@</span><span class="k">i</span> <span class="o">*</span> <span class="nt">4</span><span class="o">),</span> <span class="nt">70</span><span class="o">%,</span> <span class="nt">68</span><span class="o">%,</span> <span class="p">@</span><span class="k">r</span><span class="p">.</span><span class="nc">8</span>
  <span class="o">)</span><span class="p">;</span>
  <span class="nt">transform</span><span class="o">:</span>
    <span class="nt">scale</span><span class="o">(</span><span class="p">@</span><span class="k">r</span><span class="o">(</span><span class="p">.</span><span class="nc">8</span><span class="o">,</span> <span class="nt">1</span><span class="p">.</span><span class="nc">6</span><span class="o">))</span>
    <span class="nt">translate</span><span class="o">(</span><span class="p">@</span><span class="k">m2</span><span class="o">.</span><span class="p">@</span><span class="k">r</span><span class="o">(</span><span class="err">±</span><span class="nt">50</span><span class="o">%))</span><span class="p">;</span>
<span class="o">&lt;/</span><span class="nt">css-doodle</span><span class="o">&gt;</span>
</code></pre></div><h2 id="用-css-doodle-图形做背景">用 CSS-Doodle 图形做背景</h2>
<p>由于 <code>&lt;css-doodle&gt;...&lt;/css-doodle&gt;</code> 是一个独立的元素块。要将生成的图形做为另一个元素块儿的背景，一个方法是单独生成一个图片，然后截屏；另一个方法是用下面的代码将图形输出为背景图像。</p>
<div class="highlight"><pre class="chroma"><code class="language-css" data-lang="css"><span class="nt">background-image</span><span class="o">:</span> <span class="p">@</span><span class="k">css-doodle</span><span class="o">(</span>
<span class="c">/* 作图代码 */</span>
<span class="o">)</span>
</code></pre></div><p>需要注意的是，<code>css-doodle</code> 元素块在设计上依赖 <code>grid</code> 来生成重复的图形，所以在用上述方法的时候，可以在 <code>css-doodle</code> 元素块中加上下面这一行。</p>
<div class="highlight"><pre class="chroma"><code class="language-css" data-lang="css"><span class="p">@</span><span class="k">grid</span><span class="o">:</span> <span class="nt">1</span> <span class="o">/</span> <span class="nt">100</span><span class="o">%</span> <span class="nt">100vh</span><span class="p">;</span> <span class="c">/* 斜杠后为 grid 的宽度和长度*/</span>
</code></pre></div><p>另外，也可以加上背景色并显示背景的大小。</p>
<p>把上面这些代码合起来即可作为背景使用了。但是需要注意的是，该背景实际上是 <code>css-doodle</code> 元素块儿的背景。</p>
<div class="highlight"><pre class="chroma"><code class="language-css" data-lang="css"><span class="o">&lt;</span><span class="nt">css-doodle</span><span class="o">&gt;</span>
    <span class="p">@</span><span class="k">grid</span><span class="o">:</span> <span class="nt">1</span> <span class="o">/</span> <span class="nt">100</span><span class="o">%</span> <span class="nt">100vh</span><span class="p">;</span>
    <span class="nt">background-size</span><span class="o">:</span> <span class="nt">100</span><span class="o">%;</span>
    <span class="nt">background-image</span><span class="o">:</span> <span class="p">@</span><span class="k">doodle</span><span class="o">(</span>
      <span class="p">@</span><span class="k">grid</span><span class="o">:</span> <span class="nt">8</span> <span class="o">/</span> <span class="nt">100vmax</span><span class="p">;</span>
      <span class="p">@</span><span class="k">shape</span><span class="o">:</span> <span class="nt">clover</span> <span class="nt">5</span><span class="p">;</span>
      <span class="nt">background</span><span class="o">:</span> <span class="nt">hsla</span><span class="o">(</span>
        <span class="nt">calc</span><span class="o">(</span><span class="nt">100</span> <span class="nt">-</span> <span class="p">@</span><span class="k">i</span> <span class="o">*</span> <span class="nt">4</span><span class="o">),</span> <span class="nt">70</span><span class="o">%,</span> <span class="nt">68</span><span class="o">%,</span> <span class="p">@</span><span class="k">r</span><span class="p">.</span><span class="nc">8</span>
      <span class="o">)</span><span class="p">;</span>
      <span class="nt">transform</span><span class="o">:</span>
        <span class="nt">scale</span><span class="o">(</span><span class="p">@</span><span class="k">r</span><span class="o">(</span><span class="p">.</span><span class="nc">8</span><span class="o">,</span> <span class="nt">1</span><span class="p">.</span><span class="nc">6</span><span class="o">))</span>
        <span class="nt">translate</span><span class="o">(</span><span class="p">@</span><span class="k">m2</span><span class="o">.</span><span class="p">@</span><span class="k">r</span><span class="o">(</span><span class="err">±</span><span class="nt">50</span><span class="o">%))</span><span class="p">;</span>
    <span class="o">)</span><span class="p">;</span>
<span class="o">&lt;/</span><span class="nt">css-doodle</span><span class="o">&gt;</span>
</code></pre></div><h2 id="元素块重叠">元素块重叠</h2>
<p>要将 <code>css-doodle</code> 元素块儿作为别的元素块儿的背景，可以使用 <code>z-index</code>。例如将 <code>css-doodle</code> 的 <code>z-index</code> 设置为 -1。将要覆盖在上面的元素块儿的 <code>z-index</code> 设置为正整数。另外还需要适当的调整覆盖在 <code>css-doodle</code> 上的元素块儿的边距。这些都可以用 CSS 实现。例如, 下面的代码</p>
<div class="highlight"><pre class="chroma"><code class="language-css" data-lang="css">
<span class="o">&lt;</span><span class="nt">div</span> <span class="nt">style</span><span class="o">=</span><span class="s2">&#34;width: 100%; overflow: hidden; z-index: 2; position: relative;&#34;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nt">css-doodle</span> <span class="nt">style</span><span class="o">=</span><span class="s2">&#34;position: relative; z-index: 1; margin: -0.5px;&#34;</span><span class="o">&gt;</span>
    <span class="p">@</span><span class="k">grid</span><span class="o">:</span> <span class="nt">1</span> <span class="o">/</span> <span class="nt">100</span><span class="o">%</span> <span class="nt">100vh</span><span class="p">;</span>
    <span class="nt">background-size</span><span class="o">:</span> <span class="nt">100</span><span class="o">%;</span>
    <span class="nt">background-image</span><span class="o">:</span> <span class="p">@</span><span class="k">doodle</span><span class="o">(</span>
      <span class="p">@</span><span class="k">grid</span><span class="o">:</span> <span class="nt">8</span> <span class="o">/</span> <span class="nt">100vmax</span><span class="p">;</span>
      <span class="p">@</span><span class="k">shape</span><span class="o">:</span> <span class="nt">clover</span> <span class="nt">5</span><span class="p">;</span>
      <span class="nt">background</span><span class="o">:</span> <span class="nt">hsla</span><span class="o">(</span>
        <span class="nt">calc</span><span class="o">(</span><span class="nt">100</span> <span class="nt">-</span> <span class="p">@</span><span class="k">i</span> <span class="o">*</span> <span class="nt">4</span><span class="o">),</span> <span class="nt">70</span><span class="o">%,</span> <span class="nt">68</span><span class="o">%,</span> <span class="p">@</span><span class="k">r</span><span class="p">.</span><span class="nc">8</span>
      <span class="o">)</span><span class="p">;</span>
      <span class="nt">transform</span><span class="o">:</span>
        <span class="nt">scale</span><span class="o">(</span><span class="p">@</span><span class="k">r</span><span class="o">(</span><span class="p">.</span><span class="nc">8</span><span class="o">,</span> <span class="nt">1</span><span class="p">.</span><span class="nc">6</span><span class="o">))</span>
        <span class="nt">translate</span><span class="o">(</span><span class="p">@</span><span class="k">m2</span><span class="o">.</span><span class="p">@</span><span class="k">r</span><span class="o">(</span><span class="err">±</span><span class="nt">50</span><span class="o">%))</span><span class="p">;</span>
    <span class="o">)</span><span class="p">;</span>
  <span class="o">&lt;/</span><span class="nt">css-doodle</span><span class="o">&gt;</span>

  <span class="o">&lt;</span><span class="nt">div</span> <span class="nt">style</span><span class="o">=</span><span class="s2">&#34;position: absolute; top: 50%; left: 50%;
</span><span class="s2">   transform: translate(-50%, -50%); z-index: 3;&#34;</span><span class="o">&gt;</span>

  <span class="err">```</span><span class="nt">css</span>
  <span class="o">&lt;</span><span class="nt">css-doodle</span><span class="o">&gt;</span>
    <span class="p">@</span><span class="k">grid</span><span class="o">:</span> <span class="nt">1</span> <span class="o">/</span> <span class="nt">100</span><span class="o">%</span> <span class="nt">100vh</span><span class="p">;</span>
    <span class="nt">background-size</span><span class="o">:</span> <span class="nt">100</span><span class="o">%</span><span class="p">;</span>
    <span class="nt">background-image</span><span class="o">:</span> <span class="p">@</span><span class="k">doodle</span><span class="o">(</span>
      <span class="p">@</span><span class="k">grid</span><span class="o">:</span> <span class="nt">8</span> <span class="o">/</span> <span class="nt">100vmax</span><span class="p">;</span>
      <span class="p">@</span><span class="k">shape</span><span class="o">:</span> <span class="nt">clover</span> <span class="nt">5</span><span class="p">;</span>
      <span class="nt">background</span><span class="o">:</span> <span class="nt">hsla</span><span class="o">(</span>
        <span class="nt">calc</span><span class="o">(</span><span class="nt">100</span> <span class="nt">-</span> <span class="p">@</span><span class="k">i</span> <span class="o">*</span> <span class="nt">4</span><span class="o">),</span> <span class="nt">70</span><span class="o">%,</span> <span class="nt">68</span><span class="o">%,</span> <span class="p">@</span><span class="k">r</span><span class="p">.</span><span class="nc">8</span>
      <span class="o">)</span><span class="p">;</span>
      <span class="nt">transform</span><span class="o">:</span>
        <span class="nt">scale</span><span class="o">(</span><span class="p">@</span><span class="k">r</span><span class="o">(</span><span class="p">.</span><span class="nc">8</span><span class="o">,</span> <span class="nt">1</span><span class="p">.</span><span class="nc">6</span><span class="o">))</span>
        <span class="nt">translate</span><span class="o">(</span><span class="p">@</span><span class="k">m2</span><span class="o">.</span><span class="p">@</span><span class="k">r</span><span class="o">(</span><span class="err">±</span><span class="nt">50</span><span class="o">%))</span><span class="p">;</span>
    <span class="o">)</span><span class="p">;</span>
  <span class="o">&lt;/</span><span class="nt">css-doodle</span><span class="o">&gt;</span>
  <span class="err">```</span>

  <span class="o">&lt;/</span><span class="nt">div</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nt">div</span><span class="o">&gt;</span>

</code></pre></div><p>上面的 html+CSS 代码的效果如下</p>
<div style="width: 100%; overflow: hidden; z-index: 2; position: relative;">
  <css-doodle style="position: relative; z-index: 1; margin: -0.5px;">
    @grid: 1 / 100% 100vh;
    background-size: 100%;
    background-image: @doodle(
      @grid: 8 / 100vmax;
      @shape: clover 5;
      background: hsla(
        calc(100 - @i * 4), 70%, 68%, @r.8
      );
      transform:
        scale(@r(.8, 1.6))
        translate(@m2.@r(±50%));
    );
  </css-doodle>
  <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 3;">
<div class="highlight"><pre class="chroma"><code class="language-css" data-lang="css"><span class="o">&lt;</span><span class="nt">css-doodle</span><span class="o">&gt;</span>
  <span class="p">@</span><span class="k">grid</span><span class="o">:</span> <span class="nt">1</span> <span class="o">/</span> <span class="nt">100</span><span class="o">%</span> <span class="nt">100vh</span><span class="p">;</span>
  <span class="nt">background-size</span><span class="o">:</span> <span class="nt">100</span><span class="o">%;</span>
  <span class="nt">background-image</span><span class="o">:</span> <span class="p">@</span><span class="k">doodle</span><span class="o">(</span>
    <span class="p">@</span><span class="k">grid</span><span class="o">:</span> <span class="nt">8</span> <span class="o">/</span> <span class="nt">100vmax</span><span class="p">;</span>
    <span class="p">@</span><span class="k">shape</span><span class="o">:</span> <span class="nt">clover</span> <span class="nt">5</span><span class="p">;</span>
    <span class="nt">background</span><span class="o">:</span> <span class="nt">hsla</span><span class="o">(</span>
      <span class="nt">calc</span><span class="o">(</span><span class="nt">100</span> <span class="nt">-</span> <span class="p">@</span><span class="k">i</span> <span class="o">*</span> <span class="nt">4</span><span class="o">),</span> <span class="nt">70</span><span class="o">%,</span> <span class="nt">68</span><span class="o">%,</span> <span class="p">@</span><span class="k">r</span><span class="p">.</span><span class="nc">8</span>
    <span class="o">)</span><span class="p">;</span>
    <span class="nt">transform</span><span class="o">:</span>
      <span class="nt">scale</span><span class="o">(</span><span class="p">@</span><span class="k">r</span><span class="o">(</span><span class="p">.</span><span class="nc">8</span><span class="o">,</span> <span class="nt">1</span><span class="p">.</span><span class="nc">6</span><span class="o">))</span>
      <span class="nt">translate</span><span class="o">(</span><span class="p">@</span><span class="k">m2</span><span class="o">.</span><span class="p">@</span><span class="k">r</span><span class="o">(</span><span class="err">±</span><span class="nt">50</span><span class="o">%))</span><span class="p">;</span>
  <span class="o">)</span><span class="p">;</span>
<span class="o">&lt;/</span><span class="nt">css-doodle</span><span class="o">&gt;</span>
</code></pre></div>  </div>
</div>
<h2 id="后记">后记</h2>
<ol>
<li>
<p>为了方便维护，CSS-Doodle 作者 <a href="https://github.com/yuanchuan">Yuan Chuan</a> 为 <code>css-doodle</code> 设置了一个 <code>use</code> 属性。利用该属性，可以将 css-doodle 作图代码放入一个 CSS 变量，如 <code>--rule</code>，之后可以用 <code>use=&quot;var(--rule)&quot;</code> 调用。详情请见 <a href="https://css-doodle.com/#attribute-use">CSS-Doodle Attributes: use</a>.</p>
</li>
<li>
<p>如果用 CSS 设置元素块的格式，需要小心选用选择器才能实现元素块儿的重叠。</p>
</li>
</ol>

</main>


  <hr>
  <p class="update"> Edited on 2021 年 1 月 17 日</p>
  <hr>


<section class="comments">
  <script src="https://utteranc.es/client.js"
  repo="fyemath/Other-blogs-comments"
  issue-term="pathname"
  theme="github-light"
  crossorigin="anonymous"
  async>
</script>
</section>


</div>

<hr>
  <footer>
  
  © <a href="https://yfei.page">Fei Ye</a> 2018-2020 | <a href="https://github.com/fyemath">Github</a>
  
  </footer>
  </body>
  


<script src="/js/check-for-tex.js" defer></script>
<script async src="https://yihui.org/js/center-img.js"></script>
<script src="/js/prism.js"></script>







</html>

