<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>用Hugo创建中英混合博客 | </title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link href="/css/customized.css" type="text/css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.0/jquery.min.js"></script>

<script src="/js/thm-numbering.js"></script>
<script src="/js/article-meta-height.js"></script>
<script src="/js/background-by-season.js"></script>


<link href="/css/syntax.css" type="text/css" rel="stylesheet"/>

<link href="/css/fonts-en-cn.css" type="text/css" rel="stylesheet"/>

<link href="/css/css-doodle.css" type="text/css" rel="stylesheet"/>
<script src="https://unpkg.com/css-doodle@0.13.2/css-doodle.min.js"></script>



<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-regular.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-regular.woff" type="font/woff" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-italic.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-italic.woff" type="font/woff" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-700.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-700.woff" type="font/woff" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-700italic.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-700italic.woff" type="font/woff" crossorigin="anonymous">



<link rel="preload" as="font" href="/css/fonts/noto-sans-sc/noto-sans-sc-v12-chinese-simplified-regular.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans-sc/noto-sans-sc-v12-chinese-simplified-regular.woff" type="font/woff" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans-sc/noto-sans-sc-v12-chinese-simplified-700.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans-sc/noto-sans-sc-v12-chinese-simplified-700.woff" type="font/woff" crossorigin="anonymous">

<link rel="preload" as="font" href="/css/fonts/noto-serif-sc/noto-serif-sc-v8-chinese-simplified-regular.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-serif-sc/noto-serif-sc-v8-chinese-simplified-regular.woff" type="font/woff" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-serif-sc/noto-serif-sc-v8-chinese-simplified-700.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-serif-sc/noto-serif-sc-v8-chinese-simplified-700.woff" type="font/woff" crossorigin="anonymous">





<script>
  $(':root').css('--header-height', '0 px');

  $(document).ready(divHeight);
  $(window).on('resize', divHeight);

  function divHeight() {
    var dheight = $(".header h1").outerHeight(true)  + "px";
    document.documentElement.style.setProperty('--header-height', dheight);
  }
</script>

  </head>

  

  <body class="cn">
    <nav>
    <ul class="menu">
    
      
      <li><a href="/">首页</a></li>
      
      <li><a href="/cn/">博客</a></li>
      
      <li><a href="/cn/ctags/">标签</a></li>
      
      <li><a href="/en/">English</a></li>
      
    </ul>
    </nav>
    <hr/>




<div class="page">

<div class="article-title">
  <css-doodle use="var(--rule)" as-bg="" click-to-update=""></css-doodle>
  <div class="article-meta">
    <h1><span class="title">用Hugo创建中英混合博客</span></h1>
    <h2 class="author">
    
        Fei Ye
    
    </h2>
    <h3 class="date">2020/01/08</h3>
  </div>
</div>

<main>
<p>熟悉或者不熟悉 RStudio, 你都可以很快的用 <a href="https://bookdown.org/yihui/blogdown/">blogdown</a> 来创建一个私人博客。头一次创建，最容易当然是导入模板。以下我们将以 <a href="https://github.com/yihui/hugo-xmin">yihui/hugo-xmin</a> 为例，简述一下怎样修改模板，从而创建如本博客网站的中英混合博客。由于经验有限，这里只能介绍两个方面的修改。这两方面的修改分别参考了<a href="https://github.com/yihui/yihui.org">谢益辉的主页</a>和GitHub上关于Hugo 的 <a href="https://github.com/gohugoio/hugo/issues/1208#issuecomment-219126178">Option to change taxonomies URL</a> 的讨论。</p>
<h2 id="文件结构">文件结构</h2>
<p>默认的博客源文件(md 文件)一般都放在 <code>content\post</code> 文件夹里。对于双语博客，我倾向于一种语言一个文件夹，所以我的 <code>content</code> 目录下面设置了两文件夹: <code>en</code> 和 <code>cn</code>,前一个放英文，后一个放中文。对应的，在 <code>config.toml</code> 文件下做如下设置</p>
<div class="highlight"><pre class="chroma"><code class="language-toml" data-lang="toml"><span class="p">[</span><span class="nx">permalinks</span><span class="p">]</span>
    <span class="nx">en</span> <span class="p">=</span> <span class="s2">&#34;en/:year/:month/:day/:slug/&#34;</span>
    <span class="nx">cn</span> <span class="p">=</span> <span class="s2">&#34;cn/:year/:month/:day/:slug/&#34;</span>
</code></pre></div><p>这样设置的目的是使生成的 html 文件分别仍然在相应的文件加下。另外，<em>每个文件夹需要有一个空的 <code>_index.md</code> 文件</em>。</p>
<h2 id="博客导航栏">博客导航栏</h2>
<p>一般中英，或者多语言混排，至少有两套导航栏。本博站设置了三套，对应的 <code>config.tom</code> 中分别由 <code>[menu.main]</code>, <code>[menu.en]</code>, <code>[menu.cn]</code> 来定义：</p>
<div class="highlight"><pre class="chroma"><code class="language-toml" data-lang="toml"><span class="p">[</span><span class="nx">menu</span><span class="p">]</span>
    <span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;Home&#34;</span>
        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/&#34;</span>
        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">1</span>
    <span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;Blog&#34;</span>
        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/en/&#34;</span>
        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">2</span>
    <span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;博客&#34;</span>
        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/cn/&#34;</span>
        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">3</span>
    <span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">en</span><span class="p">]]</span>
        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;Home&#34;</span>
        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/&#34;</span>
        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">1</span>
    <span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">en</span><span class="p">]]</span>
        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;Blog&#34;</span>
        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/en/&#34;</span>
        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">2</span>
    <span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">en</span><span class="p">]]</span>
        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;Categories&#34;</span>
        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/en/categories/&#34;</span>
        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">3</span>
    <span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">en</span><span class="p">]]</span>
        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;Tags&#34;</span>
        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/en/tags/&#34;</span>
        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">4</span>
    <span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">en</span><span class="p">]]</span>
        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;中文&#34;</span>
        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/cn/&#34;</span>
        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">5</span>

    <span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">cn</span><span class="p">]]</span>
        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;首页&#34;</span>
        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/&#34;</span>
        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">1</span>
    <span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">cn</span><span class="p">]]</span>
        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;博客&#34;</span>
        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/cn/&#34;</span>
        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">2</span>
    <span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">cn</span><span class="p">]]</span>
        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;标签&#34;</span>
        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/cn/ctags/&#34;</span>
        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">3</span>
    <span class="p">[[</span><span class="nx">menu</span><span class="p">.</span><span class="nx">cn</span><span class="p">]]</span>
        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;English&#34;</span>
        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/en/&#34;</span>
        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">4</span>
</code></pre></div><p>注意导航里关于分类的目录项我也都设置到了相应的子目录。然而，要使得生成的 html 及相关的文件夹也分别在 <code>en</code> 和 <code>cn</code> 文件夹里，还需要更改默认的 <code>[taxonomies]</code>：</p>
<div class="highlight"><pre class="chroma"><code class="language-toml" data-lang="toml"><span class="p">[</span><span class="nx">taxonomies</span><span class="p">]</span>
    <span class="nx">category</span> <span class="p">=</span> <span class="s2">&#34;en/categories&#34;</span>
    <span class="nx">tag</span> <span class="p">=</span> <span class="s2">&#34;en/tags&#34;</span>
    <span class="nx">ctag</span> <span class="p">=</span> <span class="s2">&#34;cn/ctags&#34;</span>
</code></pre></div><p>需要注意的是，在为博客源文件添加分类或标签时，要保留 <code>en/</code> 和 <code>cn/</code>。例如</p>
<div class="highlight"><pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nn">---</span><span class="w">
</span><span class="w"></span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l">用Hugo创建中英混合博客</span><span class="w">
</span><span class="w"></span><span class="nt">author</span><span class="p">:</span><span class="w"> </span><span class="l">Fei Ye</span><span class="w">
</span><span class="w"></span><span class="nt">date</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;2020-01-08&#39;</span><span class="w">
</span><span class="w"></span><span class="nt">slug</span><span class="p">:</span><span class="w"> </span><span class="l">multilingual-blog-using-hugo</span><span class="w">
</span><span class="w"></span><span class="nt">cn/ctags</span><span class="p">:</span><span class="w">
</span><span class="w">  </span>- <span class="l">hugo</span><span class="w">
</span><span class="w">  </span>- <span class="l">blogdown</span><span class="w">
</span><span class="w"></span><span class="nn">---</span><span class="w">
</span></code></pre></div><p>完成这一步，还有两个问题要通过修改布局模板来解决:</p>
<ul>
<li>修改 <code>layout</code> 文件夹下的 <code>list.html</code>，从而将 <code>[menu.en]</code> 和 <code>[menu.cn]</code> 两个导航正确的显示出来;</li>
<li>修改 <code>layout</code> 文件夹下的 <code>terms.html</code>，从而能正确显示页面主题。</li>
</ul>
<h2 id="修改-listhtml">修改 <code>list.html</code></h2>
<p>在文件夹 <code>/theme/hugo-xmin/layout/_default</code> 下找到并用文件编辑器打开 <code>list.html</code>。将</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">  &lt;ul&gt;
  {{ $pages := .Pages }}
  {{ if .IsHome }}{{ $pages = .Site.RegularPages }}{{ end }}
  {{ range (where $pages &#34;Section&#34; &#34;!=&#34; &#34;&#34;) }}
</code></pre></div><p>改成</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">{{ $currentPage := . }}
{{ if .IsHome }}
{{ $.Scratch.Set &#34;pages&#34; .Site.RegularPages }}
{{ else }}
{{ $.Scratch.Set &#34;pages&#34; .Pages }}
{{ end }}
&lt;ul&gt;
    {{ range (where ($.Scratch.Get &#34;pages&#34;) &#34;Section&#34; &#34;!=&#34; &#34;&#34;) }}
</code></pre></div><p>这段修改完全是借鉴了 <code>[hugo-ivy](https://github.com/yihui/hugo-ivy)</code> 的相应设置。</p>
<h2 id="修改-termshtml">修改 <code>terms.html</code></h2>
<p>在文件夹 <code>/theme/hugo-xmin/layout/_default</code> 下找到并用文件编辑器打开 <code>terms.html</code>。将</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback"> &lt;h1&gt;{{ .Title }}&lt;/h1&gt;
</code></pre></div><p>改成</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">{{ $title:= .Title }}
{{ if (hasPrefix $title &#34;En/&#34;) }}
    {{ $title = (strings.TrimPrefix &#34;En/&#34; $title) }}
{{ else }}
    {{ $title = &#34;标签&#34; }}
{{ end }}

&lt;h1&gt;{{ $title }}&lt;/h1&gt;
</code></pre></div><p>如果中文相应的还有分类，则需要额外加一个 <code>{{ else if (condition) }}</code> 手动定义。如果未做修改，你会发现，生成的分类或者标签页面的主题显示为 <code>En/...</code> 或者 <code>Cn/...</code>。</p>
<h2 id="结语">结语</h2>
<p>最后这两步或许有更简单的方法实现。如果您有好的办法，请移步<a href="https://github.com/fyemath/Other-Posts">本博客的 github 仓库</a>提交建议或合并。谢谢！</p>

</main>


  <hr>
  <p class="update"> Edited on 2021/02/22</p>
  <hr>


<section class="comments">
  <script src="https://utteranc.es/client.js"
  repo="fyemath/Other-blogs-comments"
  issue-term="pathname"
  theme="github-light"
  crossorigin="anonymous"
  async>
</script>
</section>


</div>

<hr>
  <footer>
  
  © <a href="https://yfei.page">Fei Ye</a> 2018-2020 | <a href="https://github.com/fyemath">Github</a>
  
  </footer>
  </body>
  


<script src="/js/check-for-tex.js" defer></script>
<script async src="https://yihui.org/js/center-img.js"></script>








</html>

