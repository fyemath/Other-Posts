<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>在网页中使用思源宋体 | </title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link href="/css/customized.css" type="text/css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.0/jquery.min.js"></script>
<script src="/js/thm-numbering.js"></script>
<script src="/js/article-meta-height.js"></script>

<script src="/js/background-by-season.js"></script>

<link href="/css/prism-okaidia.css" type="text/css" rel="stylesheet"/>

<link href="/css/fonts-en-cn.css" type="text/css" rel="stylesheet"/>

<link href="/css/css-doodle.css" type="text/css" rel="stylesheet"/>

<script src="https://unpkg.com/css-doodle@0.13.2/css-doodle.min.js"></script>



<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-regular.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-regular.woff" type="font/woff" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-italic.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-italic.woff" type="font/woff" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-700.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-700.woff" type="font/woff" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-700italic.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans/noto-sans-v11-latin_greek-700italic.woff" type="font/woff" crossorigin="anonymous">



<link rel="preload" as="font" href="/css/fonts/noto-sans-sc/noto-sans-sc-v12-chinese-simplified-regular.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans-sc/noto-sans-sc-v12-chinese-simplified-regular.woff" type="font/woff" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans-sc/noto-sans-sc-v12-chinese-simplified-700.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-sans-sc/noto-sans-sc-v12-chinese-simplified-700.woff" type="font/woff" crossorigin="anonymous">

<link rel="preload" as="font" href="/css/fonts/noto-serif-sc/noto-serif-sc-v8-chinese-simplified-regular.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-serif-sc/noto-serif-sc-v8-chinese-simplified-regular.woff" type="font/woff" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-serif-sc/noto-serif-sc-v8-chinese-simplified-700.woff2" type="font/woff2" crossorigin="anonymous">
<link rel="preload" as="font" href="/css/fonts/noto-serif-sc/noto-serif-sc-v8-chinese-simplified-700.woff" type="font/woff" crossorigin="anonymous">





<script>
  $(':root').css('--header-height', '0 px');

  $(document).ready(divHeight);
  $(window).on('resize', divHeight);

  function divHeight() {
    var dheight = $(".header h1").outerHeight(true)  + "px";
    document.documentElement.style.setProperty('--header-height', dheight);
  }
</script>

  </head>

  

  <body class="cn">
    <nav>
    <ul class="menu">
    
      
      <li><a href="/">首页</a></li>
      
      <li><a href="/cn/">博客</a></li>
      
      <li><a href="/cn/ctags/">标签</a></li>
      
      <li><a href="/en/">English</a></li>
      
    </ul>
    </nav>
    <hr/>




<div class="page">

<div class="article-title">
  <css-doodle use="var(--rule)" as-bg="" click-to-update=""></css-doodle>
  <div class="article-meta">
    <h1><span class="title">在网页中使用思源宋体</span></h1>
    <h2 class="author">
    
        Fei Ye
    
    </h2>
    <h3 class="date">2020/12/12</h3>
  </div>
</div>

<main>
<h2 id="前言">前言</h2>
<p>昨天从<a href="https://d.cosx.org/d/421962-yihuicss/6">益辉的回复中</a>我了解到了开源字体：<a href="https://source.typekit.com/source-han-serif/cn/">思源宋体</a>。于是就尝试了一把。由于 adobe 需要注册才能使用 <a href="https://fonts.adobe.com/typekit">Typekit</a> 加载网络字体，而我一向不喜欢这种需要注册才能用的服务，所以就尝试了直接把字体上传的服务器的方法。对于英文字体，为了提升加载速度，通常大家会用一些字体转换软件或在线服务把开源字体转换成 <a href="https://developer.mozilla.org/en-US/docs/Web/Guide/WOFF">The Web Open Font Format (WOFF)</a>。然而不知道啥原因，对于思源宋体，我试过的几个在线转换的服务都不成功。另一方面，虽然思源宋体是开源的 (<a href="https://github.com/adobe-fonts/source-han-serif/blob/master/LICENSE.txt">SIL Open Font License 1.1</a>)，但是进行转换的时候，可能会改变原有的字体信息，从而需要进一步的处理 (参见<a href="https://scripts.sil.org/cms/scripts/page.php?item_id=OFL-FAQ_web#1b11b702">OFL-FAQ Question 2.1-2.3</a>)。 因此，我决定牺牲掉一些性能，直接使用 opentype 和 truetype 的字体。这些字体可以直接从网上现在。为了避免注册登录 adobe，我决定从 Google Fonts 下载等价的字体：<a href="https://fonts.google.com/specimen/Noto+Serif+SC#standard-styles">Noto Serif SC</a> 对应于思源宋体; <a href="https://fonts.google.com/specimen/Noto+Sans+SC">Noto Sans SC</a> 对应于思源黑体。对于无法访问 Google 的用户，也可以从第三方下载，例如 <a href="https://wordshub.github.io/free-font/">https://wordshub.github.io/free-font/</a>。</p>
<h2 id="设置字体">设置字体</h2>
<p>如何下载并设置网络字体，网上有很多教程。关键点是加载和调用。这两项都可以通过 CSS 来设置。</p>
<p>假设相关字体已经被下载并解压了，且字体所在的文件夹的名字是 <code>fonts</code>。</p>
<ul>
<li>
<p>将包含字体的文件夹 <code>fonts</code> 放到网站的一个容易找到的目录。例如本站将其置于 <code>CSS</code> 文件夹下。</p>
</li>
<li>
<p>设置 CSS 加载调用字体。为此，可以将如下的 CSS 代码存为一个 .css 文件，例如<code>fontssc.css</code>。</p>
<div class="highlight"><pre class="chroma"><code class="language-css" data-lang="css"><span class="p">@</span><span class="k">font-face</span> <span class="p">{</span>
<span class="nt">font-family</span><span class="o">:</span> <span class="s1">&#39;SiYuanSong&#39;</span><span class="o">;</span>
<span class="nt">src</span><span class="o">:</span> <span class="nt">local</span><span class="o">(</span><span class="s1">&#39;Source Han Serif CN&#39;</span><span class="o">),</span> <span class="nt">local</span><span class="o">(</span><span class="s1">&#39;Source Han Serif SC&#39;</span><span class="o">),</span> <span class="c">/*如果可能，调用本地字体*/</span>
  <span class="nt">url</span><span class="o">(</span><span class="s1">&#39;fonts/Noto_Serif_SC/NotoSerifSC-Regular.otf&#39;</span><span class="o">)</span> <span class="nt">format</span><span class="o">(</span><span class="s1">&#39;opentype&#39;</span><span class="o">);</span>
  <span class="nt">font-weight</span><span class="o">:</span> <span class="nt">400</span><span class="o">;</span>
  <span class="nt">font-style</span><span class="o">:</span> <span class="nt">normal</span><span class="o">;</span>
  <span class="nt">font-display</span><span class="o">:</span> <span class="nt">swap</span><span class="o">;</span>
<span class="p">}</span>

<span class="p">@</span><span class="k">font-face</span> <span class="p">{</span>
  <span class="nt">font-family</span><span class="o">:</span> <span class="s1">&#39;SiYuanSong&#39;</span><span class="o">;</span>
  <span class="nt">src</span><span class="o">:</span> <span class="nt">local</span><span class="o">(</span><span class="s1">&#39;Source Han Serif CN&#39;</span><span class="o">),</span> <span class="nt">local</span><span class="o">(</span><span class="s1">&#39;Source Han Serif SC&#39;</span><span class="o">),</span> <span class="c">/*如果可能，调用本地字体*/</span>
    <span class="nt">url</span><span class="o">(</span><span class="s1">&#39;fonts/Noto_Serif_SC/NotoSerifSC-Bold.otf&#39;</span><span class="o">)</span> <span class="nt">format</span><span class="o">(</span><span class="s1">&#39;opentype&#39;</span><span class="o">);</span>
  <span class="nt">font-weight</span><span class="o">:</span> <span class="nt">700</span><span class="o">;</span>
  <span class="nt">font-style</span><span class="o">:</span> <span class="nt">normal</span><span class="o">;</span>
  <span class="nt">font-display</span><span class="o">:</span> <span class="nt">swap</span><span class="o">;</span>
<span class="p">}</span>

<span class="nt">body</span><span class="p">{</span>
  <span class="k">font-family</span><span class="p">:</span> <span class="s1">&#39;SiYuanSong&#39;</span><span class="p">,</span> <span class="kc">serif</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></li>
<li>
<p>在网页的 <code>&lt;head&gt;...&lt;/head&gt;</code> 里面加入下面一行即可。</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/css/fonts-customized.css&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/css&#34;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span><span class="p">/&gt;</span>
</code></pre></div></li>
</ul>
<h2 id="后记">后记</h2>
<ul>
<li>
<p>为了增强网页打开后的刷新速度，可以用 <code>rel=&quot;preload&quot;</code> 来预加载字体。具体来说，将下面的代码加入 <code>&lt;head&gt;...&lt;/head&gt;</code> 里面即可。</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;preload&#34;</span> <span class="na">as</span><span class="o">=</span><span class="s">&#34;font&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/css/fonts/Noto_Serif_SC/NotoSerifSC-Regular.otf&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;font/otf&#34;</span> <span class="na">crossorigin</span><span class="o">=</span><span class="s">&#34;anonymous&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;preload&#34;</span> <span class="na">as</span><span class="o">=</span><span class="s">&#34;font&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/css/fonts/Noto_Serif_SC/NotoSerifSC-Bold.otf&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;font/otf&#34;</span> <span class="na">crossorigin</span><span class="o">=</span><span class="s">&#34;anonymous&#34;</span><span class="p">&gt;</span>
</code></pre></div></li>
<li>
<p>如果网页是中英混排，且只希望读者在阅读英文时加载中文字体，可以参见<a href="https://yihui.org/cn/2017/04/source-han-serif/#fn:-1">益辉的解决办法</a>。</p>
</li>
<li>
<p>在使用上面提供的代码时，请注意修改相应的路径和文件名。</p>
</li>
</ul>
<h2 id="补充20201221">补充（2020/12/21）</h2>
<p>网上介绍的用于生成中文网络字体的工具大多基于百度的 <a href="https://github.com/ecomfe/fontmin">fontmin</a>。 经测试，这些字体对于抽取整个网站字体并制作字体子集并不容易。经过的搜索和测试，终于找到一款可以很容易将 ttf 转换成 woff 的工具：<a href="https://github.com/fontello/ttf2woff">ttf2woff</a>。通过 <a href="https://github.com/fontforge/fontforge">fontforge</a> 对比信息，似乎 ttf2woff 仅仅是压缩了字体，所以应该可以放心使用。</p>
<h2 id="补充202118">补充（2021/1/8）</h2>
<p>今天在 <a href="https://matze.rocks/posts/self_host_google_fonts/">Host Google webfonts yourself</a> 这篇博客中了解到了一款生成网页版 google 字体的在线工具 <a href="https://google-webfonts-helper.herokuapp.com/fonts">google-webfonts-helper
A Hassle-Free Way to Self-Host Google Fonts</a>。试用了一下，下载下来的字体比用 fontforge 转换得到的字体文件小。所以速度上还是优势的。特此推荐。</p>

</main>


  <hr>
  <p class="update"> Edited on 2021 年 2 月 22 日</p>
  <hr>


<section class="comments">
  <script src="https://utteranc.es/client.js"
  repo="fyemath/Other-blogs-comments"
  issue-term="pathname"
  theme="github-light"
  crossorigin="anonymous"
  async>
</script>
</section>


</div>

<hr>
  <footer>
  
  © <a href="https://yfei.page">Fei Ye</a> 2018-2020 | <a href="https://github.com/fyemath">Github</a>
  
  </footer>
  </body>
  


<script src="/js/check-for-tex.js" defer></script>
<script async src="https://yihui.org/js/center-img.js"></script>
<script src="/js/prism.js"></script>







</html>

