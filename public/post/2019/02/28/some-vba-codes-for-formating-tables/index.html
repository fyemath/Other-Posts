<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Some VBA Codes for Formating Tables | Learning by Writing in Mathematics</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/about/">About</a></li>
      
      <li><a href="/topics/">Topics</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Some VBA Codes for Formating Tables</span></h1>

<h2 class="date">2019/02/28</h2>
</div>

<main>


<h1 id="some-vba-codes-for-formating-tables">Some VBA Codes for Formating Tables</h1>

<ul>
<li>Step 1: In <code>Word</code> -&gt; <code>File</code> -&gt; <code>Options</code> -&gt; <code>Customize Ribbon</code>, check <code>Developer</code> in &lsquo;Customize the ribbon&rsquo; and click ok.</li>
<li>Step 2: In Ribbons, find and click <code>Developer</code> -&gt; <code>Visual Basic</code> (<code>Alt</code>+<code>F11</code>).</li>
<li>Step 3: In the pop out windows, click <code>Module</code> on the <code>Insert tab</code>, copy and paste the following VBA code into the Module window and click the <code>Run</code> tab (<code>F5</code>) to run the macro.
<br /></li>
</ul>

<h2 id="set-table-column-width">Set table column width</h2>

<pre><code class="language-vb">Sub resizeTables()
For Each Table In ActiveDocument.Tables                     'Loop all tables in the active document
    Table.PreferredWidthType = wdPreferredWidthPercent      'Accept preferred widths as a percentage of window width,
    Table.PreferredWidth = 100                              'Set table width=100%
    On Error Resume Next
    Table.Columns(1).PreferredWidth = 50                    'Set Column 1 width to 45%.
    Table.Columns(2).PreferredWidth = 10                    'Set Column 2 width to 10%
    Table.Columns(3).PreferredWidth = 40                    'Set Column 3 width to 45%
    On Error GoTo 0                                         'Apply to table with less columns
Next
End Sub
</code></pre>

<h2 id="add-border-lines">Add Border Lines</h2>

<pre><code class="language-vb">Sub addborderTables()
    For Each Table In ActiveDocument.Tables                 'Loop all tables in the active document
        With Table.Borders                                  'Choose table border for action
            .InsideLineStyle = wdLineStyleSingle            'Inside line style
            .OutsideLineStyle = wdLineStyleSingle           'Outside line style
        End With
        With Table.Rows(1).Borders(wdBorderBottom)          'Choose row(1) bottom line for action
            .LineStyle = wdLineStyleDouble                  'Set line style to double line
        End With
        Table.Rows(1).Range.Font.Bold = True                'Set fonts in row(1) to bold
    Next
End Sub
</code></pre>

<h2 id="useful-websites">Useful Websites</h2>

<ul>
<li><p><a href="https://docs.microsoft.com/en-us/office/vba/api/overview/">Office VBA Reference</a></p></li>

<li><p>The accepted answer in <a href="https://superuser.com/questions/838568/how-to-change-column-width-for-all-word-tables-at-once">How to Change Column Width for All Word Tables at Once</a>.</p></li>
</ul>

</main>

  <footer>
  <script src="//yihui.name/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.name/js/center-img.js"></script>

  
  <hr/>
  &copy; <a href="https://yfei.page">Fei Ye</a> 2019 | <a href="https://github.com/fyemath">Github</a>
  
  </footer>
  </body>
</html>

