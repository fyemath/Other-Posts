<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Some VBA Codes for Formating Tables | </title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" type="text/css" href="css/customized.css"/>
  </head>

  

  <body class="en">
    <nav>
    <ul class="menu">
    
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/en/">Blog</a></li>
      
      <li><a href="/en/categories/">Categories</a></li>
      
      <li><a href="/en/tags/">Tags</a></li>
      
      <li><a href="/cn/">中文</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Some VBA Codes for Formating Tables</span></h1>

<h2 class="author">

    Fei Ye

</h2>
<h2 class="date">2019/02/28</h2>
</div>

<main>
<h1 id="some-vba-codes-for-formating-tables">Some VBA Codes for Formating Tables</h1>
<ul>
<li>Step 1: In <code>Word</code> -&gt; <code>File</code> -&gt; <code>Options</code> -&gt; <code>Customize Ribbon</code>, check <code>Developer</code> in &lsquo;Customize the ribbon&rsquo; and click ok.</li>
<li>Step 2: In Ribbons, find and click <code>Developer</code> -&gt; <code>Visual Basic</code> (<code>Alt</code>+<code>F11</code>).</li>
<li>Step 3: In the pop out windows, click <code>Module</code> on the <code>Insert tab</code>, copy and paste the following VBA code into the Module window and click the <code>Run</code> tab (<code>F5</code>) to run the macro.</li>
</ul>
<h2 id="set-table-column-width">Set table column width</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vb" data-lang="vb"><span style="color:#66d9ef">Sub</span> <span style="color:#a6e22e">resizeTables</span>()
<span style="color:#66d9ef">For</span> <span style="color:#66d9ef">Each</span> Table <span style="color:#f92672">In</span> ActiveDocument.Tables                     <span style="color:#75715e">&#39;Loop all tables in the active document
</span><span style="color:#75715e"></span>    Table.PreferredWidthType <span style="color:#f92672">=</span> wdPreferredWidthPercent      <span style="color:#75715e">&#39;Accept preferred widths as a percentage of window width,
</span><span style="color:#75715e"></span>    Table.PreferredWidth <span style="color:#f92672">=</span> 100                              <span style="color:#75715e">&#39;Set table width=100%
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">On</span> <span style="color:#66d9ef">Error</span> <span style="color:#66d9ef">Resume</span> <span style="color:#66d9ef">Next</span>
    Table.Columns(1).PreferredWidth <span style="color:#f92672">=</span> 50                    <span style="color:#75715e">&#39;Set Column 1 width to 45%.
</span><span style="color:#75715e"></span>    Table.Columns(2).PreferredWidth <span style="color:#f92672">=</span> 10                    <span style="color:#75715e">&#39;Set Column 2 width to 10%
</span><span style="color:#75715e"></span>    Table.Columns(3).PreferredWidth <span style="color:#f92672">=</span> 40                    <span style="color:#75715e">&#39;Set Column 3 width to 45%
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">On</span> <span style="color:#66d9ef">Error</span> <span style="color:#66d9ef">GoTo</span> 0                                         <span style="color:#75715e">&#39;Apply to table with less columns
</span><span style="color:#75715e"></span><span style="color:#66d9ef">Next</span>
<span style="color:#66d9ef">End</span> <span style="color:#66d9ef">Sub</span>
</code></pre></div><h2 id="add-border-lines">Add Border Lines</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-vb" data-lang="vb"><span style="color:#66d9ef">Sub</span> <span style="color:#a6e22e">addborderTables</span>()
    <span style="color:#66d9ef">For</span> <span style="color:#66d9ef">Each</span> Table <span style="color:#f92672">In</span> ActiveDocument.Tables                 <span style="color:#75715e">&#39;Loop all tables in the active document
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">With</span> Table.Borders                                  <span style="color:#75715e">&#39;Choose table border for action
</span><span style="color:#75715e"></span>            .InsideLineStyle <span style="color:#f92672">=</span> wdLineStyleSingle            <span style="color:#75715e">&#39;Inside line style
</span><span style="color:#75715e"></span>            .OutsideLineStyle <span style="color:#f92672">=</span> wdLineStyleSingle           <span style="color:#75715e">&#39;Outside line style
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">End</span> <span style="color:#66d9ef">With</span>
        <span style="color:#66d9ef">With</span> Table.Rows(1).Borders(wdBorderBottom)          <span style="color:#75715e">&#39;Choose row(1) bottom line for action
</span><span style="color:#75715e"></span>            .LineStyle <span style="color:#f92672">=</span> wdLineStyleDouble                  <span style="color:#75715e">&#39;Set line style to double line
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">End</span> <span style="color:#66d9ef">With</span>
        Table.Rows(1).Range.Font.Bold <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>                <span style="color:#75715e">&#39;Set fonts in row(1) to bold
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">Next</span>
<span style="color:#66d9ef">End</span> <span style="color:#66d9ef">Sub</span>
</code></pre></div><h2 id="useful-websites">Useful Websites</h2>
<ul>
<li>
<p><a href="https://docs.microsoft.com/en-us/office/vba/api/overview/">Office VBA Reference</a></p>
</li>
<li>
<p>The accepted answer in <a href="https://superuser.com/questions/838568/how-to-change-column-width-for-all-word-tables-at-once">How to Change Column Width for All Word Tables at Once</a>.</p>
</li>
</ul>

</main>

  <footer>
  <script src="//yihui.name/js/math-code.js"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.0.0/es5/latest?tex-mml-chtml.js">
</script>
<script>
    MathJax = {
        tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    }
</script>
<script async src="//yihui.name/js/center-img.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>

<script>
hljs.configure({languages: ["r","yaml","toml","tex","markdown"]});
</script>

<script src="/js/check-for-tex.js" defer></script>
  
  <hr/>
  © <a href="https://yfei.page">Fei Ye</a> 2019-now | <a href="https://github.com/fyemath">Github</a>
  
  </footer>
  </body>
</html>

